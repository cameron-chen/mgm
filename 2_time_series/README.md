# Experiment for time seriesd
This folder details the time series data experiment.

The implementation is built on [COT-GAN](https://github.com/tianlinxu312/cot-gan-pytorch). We thank for their prior work. 

## Setup
### Requirements
- Hardware: GPU
- Deploy the Linux environment by docker image provided by Nvidia: https://docs.nvidia.com/deeplearning/frameworks/pytorch-release-notes/rel_20-03.html.
- Install dependencies in: `requirements.txt`
- Note the environment and code are tested on a local server (Intel(R) Xeon(R) Gold 5218R CPU, 2x Quadro RTX 6000, 128GB RAM)

### Data
You can try two types of data:
- **Autoregressive processes**. The data will be generated by the implementation itself. 
- **Electric data**. The data is publicly shared by [Red Electrica de Espana](https://www.esios.ree.es/en).


## Training MGM
The procedure of training a MGM model: 1. Pretrain a mixer, 2. Train the MGM. 

The implementation provides a flag to specify the trianing object, such as an agent (`agent`), a mixer (`mixer`), a MGM model (`hierP`). For example, to train an agent: 

```
# Train agent
$ python main.py \
    --object agent
    --tb_log 1
    --dname AROne
    --training_mode single_run
```

See the code for how to modify the default values of other training parameters or hyperparameters.